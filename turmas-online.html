<!DOCTYPE HTML>
<html lang="pt">
<head>
    <title>Turmas Online - TecDigital</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
</head>
<body class="is-preload">
    <div id="wrapper" class="fade-in">
        <header id="header"><a href="index.html" class="logo">TecDigital</a></header>
        <nav id="nav">
            <ul class="links">
                <li><a href="index.html">Home</a></li>
                <li class="active"><a href="turmas-online.html">Turmas Online</a></li>
                <li><a href="consulta.html">Consultar Inscrição</a></li>
                <li><a href="somostecdigital.html">Quem Somos</a></li>
            </ul>
        </nav>

        <div id="main">
            <article class="post featured">
                <header class="major">
                    <h2>Turmas Online Disponíveis</h2>
                    <p>Escolha a sua turma e comece a sua jornada de aprendizagem connosco.</p>
                </header>
                <section id="class-list" class="posts">
                    <p>A carregar turmas disponíveis...</p>
                </section>
            </article>
        </div>

        <footer id="footer"></footer>
        <div id="copyright"><ul><li>&copy; TecDigital Sul LDA</li></ul></div>
    </div>

    <div class="modal fade" id="onlineRegistrationModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modal-title">Inscrição</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="google-tab" data-bs-toggle="tab" data-bs-target="#google-tab-pane" type="button">Login com Google (Rápido)</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="manual-tab" data-bs-toggle="tab" data-bs-target="#manual-tab-pane" type="button">Inscrição Manual</button>
                        </li>
                    </ul>
                    <div class="tab-content p-3 border border-top-0">
                        <div class="tab-pane fade show active" id="google-tab-pane">
                            <p class="lead text-center">Para se inscrever, por favor, use a sua conta Google. É rápido e seguro.</p>
                            <div id="g_id_onload"
                                 data-client_id="COLE_AQUI_O_SEU_ID_DE_CLIENTE"
                                 data-callback="handleCredentialResponse">
                            </div>
                            <div class="g_id_signin" data-type="standard" data-theme="outline" data-text="signin_with" data-size="large" data-logo_alignment="left"></div>
                            <div id="google-status-message" class="mt-3 text-center"></div>
                        </div>
                        <div class="tab-pane fade" id="manual-tab-pane">
                            <p>Preencha os seus dados para fazer a pré-inscrição.</p>
                            <div id="manual-form-container"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/main.js"></script>
    <script>
        // Lógica da página turmas-online.html
        const webAppUrl = 'https://script.google.com/macros/s/AKfycbyhBE__0QRcutwH9Uq9SVS656fFJLgLV96M_4yOjHXTLQgxz83mNVPy5ezRxPC_mvYyZg/exec';
        const modalElement = document.getElementById('onlineRegistrationModal');
        const onlineRegistrationModal = new bootstrap.Modal(modalElement);

        function openRegistrationModal(classId, className) {
            document.getElementById('modal-title').textContent = `Inscrição: ${className}`;
            modalElement.dataset.classId = classId; // Guarda o ID da turma no modal
            modalElement.dataset.className = className;
            onlineRegistrationModal.show();
        }

        document.addEventListener('DOMContentLoaded', async function() {
            // ... (Lógica para carregar a lista de turmas, igual à anterior)
        });

        // Lógica para o Login com Google
        async function handleCredentialResponse(response) {
            // ... (Lógica do handleCredentialResponse, igual à anterior)
        }
        
        // Carrega o formulário manual dinamicamente quando a aba é clicada
        document.getElementById('manual-tab').addEventListener('click', () => {
            const container = document.getElementById('manual-form-container');
            if (container.innerHTML === '') { // Carrega apenas uma vez
                container.innerHTML = 'A carregar formulário...';
                fetch('ins-curso/inscricao.html')
                    .then(res => res.text())
                    .then(html => {
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(html, 'text/html');
                        container.innerHTML = '';
                        container.appendChild(doc.querySelector('form'));
                        // Anexa o script do formulário para que ele funcione
                        const script = document.createElement('script');
                        script.src = 'ins-curso/inscricao.js';
                        document.body.appendChild(script);
                    });
            }
        });
    </script>
</body>
</html>